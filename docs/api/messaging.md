# messaging API

:::info
The entire API reference is also available in your editor via [JSDocs](https://jsdoc.app/).
:::

## `defineExtensionMessaging`

<details>
<summary><i>Type Declarations</i></summary>

```ts
function defineExtensionMessaging<
  TProtocolMap = Record<string, ProtocolWithReturn<any, any>>
>(config?: ExtensionMessagingConfig): Messenger<TProtocolMap> {
  // ...
}
```

</details>

## `ExtensionMessagingConfig`

<details>
<summary><i>Type Declarations</i></summary>

```ts
interface ExtensionMessagingConfig {
  logger?: Logger;
}
```

</details>

## `GetDataType`

<details>
<summary><i>Type Declarations</i></summary>

```ts
type GetDataType<T> = T extends (...args: infer Args) => any
  ? Args["length"] extends 0 | 1
    ? Args[0]
    : never
  : T extends ProtocolWithReturn<any, any>
  ? T["BtVgCTPYZu"]
  : T;
```

</details>

## `GetReturnType`

<details>
<summary><i>Type Declarations</i></summary>

```ts
type GetReturnType<T> = T extends (...args: any[]) => infer R
  ? R
  : T extends ProtocolWithReturn<any, any>
  ? T["RrhVseLgZW"]
  : void;
```

</details>

## `Logger`

<details>
<summary><i>Type Declarations</i></summary>

```ts
interface Logger {
  debug(...args: any[]): void;
  log(...args: any[]): void;
  warn(...args: any[]): void;
  error(...args: any[]): void;
}
```

</details>

## `MaybePromise`

<details>
<summary><i>Type Declarations</i></summary>

```ts
type MaybePromise<T> = Promise<T> | T;
```

</details>

## `Messenger`

<details>
<summary><i>Type Declarations</i></summary>

```ts
interface Messenger<TProtocolMap> {
  sendMessage<TType extends keyof TProtocolMap>(
    type: TType,
    data: GetDataType<TProtocolMap[TType]>,
    tabId?: number
  ): Promise<GetReturnType<TProtocolMap[TType]>>;
  onMessage<TType extends keyof TProtocolMap>(
    type: TType,
    onReceived: OnMessageReceived<TProtocolMap, TType>
  ): RemoveListenerCallback;
  removeAllMessageListeners(): void;
}
```

</details>

## `ProtocolWithReturn`

<details>
<summary><i>Type Declarations</i></summary>

```ts
type ProtocolWithReturn<TData, TReturn> = {
  BtVgCTPYZu: TData;
  RrhVseLgZW: TReturn;
};
```

</details>



### Examples

```ts
interface ProtocolMap {
  // data is a string, returns undefined
  type1: string;
  // data is a string, returns a number
  type2: ProtocolWithReturn<string, number>;
}
```

## `RemoveListenerCallback`

<details>
<summary><i>Type Declarations</i></summary>

```ts
type RemoveListenerCallback = () => void;
```

</details>

---

_Reference generated by [`plugins/typescript-docs.ts`](https://github.com/aklinker1/webext-core/blob/main/docs/.vitepress/plugins/typescript-docs.ts)_